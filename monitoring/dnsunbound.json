{
  "dashboard": {
    "id": null,
    "uid": "unbound-complete-isp",
    "title": "UNBOUND DNS Resolver - ISP Complete Dashboard - BR10IA",
    "tags": ["unbound", "dns", "resolver", "isp", "br10ia"],
    "timezone": "",
    "schemaVersion": 39,
    "version": 4,
    "refresh": "10s",
    "panels": [
      {
        "type": "row",
        "title": "Visão Geral",
        "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 }
      },
      {
        "type": "stat",
        "title": "Queries por Segundo",
        "datasource": "Prometheus",
        "gridPos": { "x": 0, "y": 1, "w": 6, "h": 3 },
        "targets": [
          { "expr": "rate(unbound_num_queries[5m])", "legendFormat": "" }
        ]
      },
      {
        "type": "stat",
        "title": "Cache Hit (%)",
        "datasource": "Prometheus",
        "gridPos": { "x": 6, "y": 1, "w": 6, "h": 3 },
        "targets": [
          {
            "expr": "(rate(unbound_num_cachehits[5m]) / (rate(unbound_num_cachehits[5m]) + rate(unbound_num_cachemiss[5m]))) * 100",
            "legendFormat": ""
          }
        ]
      },
      {
        "type": "stat",
        "title": "DNSSEC Validações / s",
        "datasource": "Prometheus",
        "gridPos": { "x": 12, "y": 1, "w": 6, "h": 3 },
        "targets": [
          { "expr": "rate(unbound_num_valrecursivereplies[5m])", "legendFormat": "" }
        ]
      },
      {
        "type": "stat",
        "title": "Latência Média (ms)",
        "datasource": "Prometheus",
        "gridPos": { "x": 18, "y": 1, "w": 6, "h": 3 },
        "targets": [
          { "expr": "unbound_total_query_time_avg", "legendFormat": "" }
        ]
      },
      {
        "type": "row",
        "title": "Tipos de Consultas (A/AAAA/PTR/MX/TXT/SRV/NS)",
        "gridPos": { "x": 0, "y": 4, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "Query Types",
        "gridPos": { "x": 0, "y": 5, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          { "expr": "rate(unbound_num_query_type_A[5m])", "legendFormat": "A" },
          { "expr": "rate(unbound_num_query_type_AAAA[5m])", "legendFormat": "AAAA" },
          { "expr": "rate(unbound_num_query_type_PTR[5m])", "legendFormat": "PTR" },
          { "expr": "rate(unbound_num_query_type_MX[5m])", "legendFormat": "MX" },
          { "expr": "rate(unbound_num_query_type_TXT[5m])", "legendFormat": "TXT" },
          { "expr": "rate(unbound_num_query_type_SRV[5m])", "legendFormat": "SRV" },
          { "expr": "rate(unbound_num_query_type_NS[5m])", "legendFormat": "NS" }
        ]
      },
      {
        "type": "row",
        "title": "Cache",
        "gridPos": { "x": 0, "y": 13, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "Cache Hit x Miss",
        "gridPos": { "x": 0, "y": 14, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          { "expr": "rate(unbound_num_cachehits[5m])", "legendFormat": "Hits" },
          { "expr": "rate(unbound_num_cachemiss[5m])", "legendFormat": "Miss" }
        ]
      },
      {
        "type": "graph",
        "title": "RRSet Cache Usage",
        "gridPos": { "x": 0, "y": 22, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "unbound_rrset_cache_count",
            "legendFormat": "RRSet Count"
          }
        ]
      },
      {
        "type": "graph",
        "title": "Message Cache Usage",
        "gridPos": { "x": 12, "y": 22, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "unbound_msg_cache_count",
            "legendFormat": "Message Cache Count"
          }
        ]
      },
      {
        "type": "row",
        "title": "Erros e Falhas",
        "gridPos": { "x": 0, "y": 30, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "SERVFAIL / NXDOMAIN",
        "gridPos": { "x": 0, "y": 31, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "increase(unbound_num_servfail[5m])",
            "legendFormat": "SERVFAIL"
          },
          {
            "expr": "increase(unbound_num_nxdomain[5m])",
            "legendFormat": "NXDOMAIN"
          }
        ]
      },
      {
        "type": "graph",
        "title": "Unwanted Replies",
        "gridPos": { "x": 0, "y": 39, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "increase(unbound_num_unwanted_replies[5m])",
            "legendFormat": "Unwanted Replies"
          }
        ]
      },
      {
        "type": "graph",
        "title": "Zero TTL Responses",
        "gridPos": { "x": 12, "y": 39, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "increase(unbound_num_zero_ttl_responses[5m])",
            "legendFormat": "Zero TTL"
          }
        ]
      },
      {
        "type": "row",
        "title": "Latência e Timeouts",
        "gridPos": { "x": 0, "y": 47, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "TCP / UDP Timeouts",
        "gridPos": { "x": 0, "y": 48, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "increase(unbound_num_tcp_outgoing_timeouts[5m])",
            "legendFormat": "TCP Timeout"
          },
          {
            "expr": "increase(unbound_num_udp_outgoing_timeouts[5m])",
            "legendFormat": "UDP Timeout"
          }
        ]
      },
      {
        "type": "row",
        "title": "Recursão & DNSSEC",
        "gridPos": { "x": 0, "y": 56, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "Respostas Recursivas",
        "gridPos": { "x": 0, "y": 57, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "rate(unbound_num_recursivereplies[5m])",
            "legendFormat": "Recursivas"
          }
        ]
      },
      {
        "type": "graph",
        "title": "DNSSEC Queries",
        "gridPos": { "x": 0, "y": 65, "w": 24, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "rate(unbound_num_dnssec[5m])",
            "legendFormat": "DNSSEC Queries"
          }
        ]
      },
      {
        "type": "row",
        "title": "Memória / Slabs / Infra",
        "gridPos": { "x": 0, "y": 73, "w": 24, "h": 1 }
      },
      {
        "type": "graph",
        "title": "Uso de Memória - RRSet Cache",
        "gridPos": { "x": 0, "y": 74, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          { "expr": "unbound_mem_cache_rrset", "legendFormat": "" }
        ]
      },
      {
        "type": "graph",
        "title": "Uso de Memória - Message Cache",
        "gridPos": { "x": 12, "y": 74, "w": 12, "h": 8 },
        "datasource": "Prometheus",
        "targets": [
          { "expr": "unbound_mem_cache_message", "legendFormat": "" }
        ]
      },
      {
        "type": "stat",
        "title": "Uptime (s)",
        "gridPos": { "x": 0, "y": 82, "w": 6, "h": 3 },
        "datasource": "Prometheus",
        "targets": [{ "expr": "unbound_time_up" }]
      }
    ]
  },
  "overwrite": true
}
